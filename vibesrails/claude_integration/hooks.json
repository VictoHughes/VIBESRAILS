{
  "$schema": "https://raw.githubusercontent.com/anthropics/claude-code/main/schemas/hooks.json",
  "hooks": {
    "SessionStart": [
      {
        "type": "command",
        "command": "python3 -c \"import sys; from pathlib import Path; p=Path('vibesrails.yaml'); sys.exit(0 if p.exists() else 1)\" || echo 'üí° vibesrails: Run `vibesrails --setup` for auto-security setup'",
        "description": "Check if vibesrails is configured"
      },
      {
        "type": "command",
        "command": "python3 -c \"from pathlib import Path; plans=sorted(Path('docs/plans').glob('*.md'), key=lambda p: p.stat().st_mtime, reverse=True) if Path('docs/plans').exists() else []; print(f'üìã Plan actif: {plans[0].name}') if plans else None\"",
        "description": "Show active plan from docs/plans/"
      },
      {
        "type": "command",
        "command": "python3 -c \"from pathlib import Path; p=Path('.claude/current-task.md'); print(f'üìå T√¢che en cours: {p.read_text().strip()[:80]}...') if p.exists() and p.read_text().strip() else None\"",
        "description": "Show current task memo"
      }
    ],
    "PreToolUse": [
      {
        "type": "command",
        "matcher": "Write|Edit",
        "command": "python3 -c \"from pathlib import Path; print('üõ°Ô∏è vibesrails: Code will be scanned on commit' if Path('vibesrails.yaml').exists() else '')\"",
        "description": "Remind about vibesrails scanning"
      }
    ],
    "PreCompact": [
      {
        "type": "prompt",
        "prompt": "AVANT COMPACTION: Sauvegarde automatique de l'√©tat. √âcris un r√©sum√© de la t√¢che en cours dans .claude/current-task.md avec: 1) Le plan actif (docs/plans/*.md), 2) L'√©tape actuelle, 3) Les prochaines actions. Format: markdown court, 5-10 lignes max.",
        "description": "Auto-save task state before compaction"
      }
    ]
  }
}
